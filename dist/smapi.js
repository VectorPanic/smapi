(function(){var a={controller:{},net:{},system:{}};a.net.Request=function(b,c,d){this.m_args=b||{};this.m_endpoint="https://smapi.lnu.se/api/";this.m_handler=c||null;this.m_scope=d||window;this.m_xhr=null;this.m_construct()};Object.defineProperty(a.net.Request.prototype,"xhr",{get:function(){return this.m_xhr}});a.net.Request.prototype.abort=function(){this.m_disposeXMLHttpRequest()};a.net.Request.prototype.send=function(){this.m_xhr.open("GET",this.m_getURL(this.m_args));this.m_xhr.send()};a.net.Request.prototype.m_construct=function(){this.m_constructXMLHttpRequest()};
a.net.Request.prototype.m_constructXMLHttpRequest=function(){var b=this;this.m_disposeXMLHttpRequest();null===this.m_xhr&&(this.m_xhr=new XMLHttpRequest,this.m_xhr.onreadystatechange=function(c){b.m_onStateChange(c)})};a.net.Request.prototype.m_onStateChange=function(){this.m_xhr&&this.m_xhr.readyState===XMLHttpRequest.DONE&&"function"===typeof this.m_handler&&this.m_handler.call(this.m_scope,JSON.parse(this.m_xhr.responseText))};
a.net.Request.prototype.m_disposeXMLHttpRequest=function(){this.m_xhr instanceof XMLHttpRequest&&this.m_xhr.abort();this.m_xhr=null};a.net.Request.prototype.m_getURL=function(b){b=b||{};return this.m_endpoint+"?"+Object.keys(b).map(function(c){return c+"="+encodeURIComponent(b[c])}).join("&")};a.controller.Controller=function(b,c){this.m_key=b||"";this.m_name=c;this.m_endpoint="http://172.18.8.151/api/"};a.controller.Controller.prototype.getAll=function(b,c,d){b=new a.net.Request(this.m_parseArguments(b,{api_key:this.m_key,controller:this.m_name,method:"getall"}),c,d);b.send();return b};a.controller.Controller.prototype.getfromlatlng=function(b,c,d){b=new a.net.Request(this.m_parseArguments(b,{api_key:this.m_key,controller:this.m_name,method:"getfromlatlng"}),c,d);b.send();return b};
a.controller.Controller.prototype.m_parseArguments=function(b,c){return Object.assign(c,b,{js_api:!0})};a.controller.Accommodation=function(b){a.controller.Controller.call(this,b,"Accommodation")};a.controller.Accommodation.prototype=Object.create(a.controller.Controller.prototype);a.controller.Accommodation.prototype.constructor=a.controller.Accommodation;a.controller.Activity=function(b){a.controller.Controller.call(this,b,"Activity")};a.controller.Activity.prototype=Object.create(a.controller.Controller.prototype);a.controller.Activity.prototype.constructor=a.controller.Activity;a.controller.Attraction=function(b){a.controller.Controller.call(this,b,"Attraction")};a.controller.Attraction.prototype=Object.create(a.controller.Controller.prototype);a.controller.Attraction.prototype.constructor=a.controller.Attraction;a.controller.Establishment=function(b){a.controller.Controller.call(this,b,"Establishment")};a.controller.Establishment.prototype=Object.create(a.controller.Controller.prototype);a.controller.Establishment.prototype.constructor=a.controller.Establishment;a.controller.Establishment.prototype.getDescriptions=function(b){b=new a.net.Request({api_key:this.m_key,controller:this.m_name,method:"getdescriptions"},b);b.send();return b};
a.controller.Establishment.prototype.getReviews=function(b,c){b=new a.net.Request(this.m_parseArguments(b,{api_key:this.m_key,controller:this.m_name,method:"getreviews"}),c);b.send();return b};a.controller.Establishment.prototype.getStats=function(b){b=new a.net.Request({api_key:this.m_key,controller:this.m_name,method:"getstats"},b);b.send();return b};a.controller.Food=function(b){a.controller.Controller.call(this,b,"Food")};a.controller.Food.prototype=Object.create(a.controller.Controller.prototype);a.controller.Food.prototype.constructor=a.controller.Food;a.controller.Shop=function(b){a.controller.Controller.call(this,b,"Shop")};a.controller.Shop.prototype=Object.create(a.controller.Controller.prototype);a.controller.Shop.prototype.constructor=a.controller.Shop;a.system.Main=function(b){this.m_accommodation=new a.controller.Accommodation(b);this.m_activity=new a.controller.Activity(b);this.m_attraction=new a.controller.Attraction(b);this.m_establishment=new a.controller.Establishment(b);this.m_food=new a.controller.Food(b);this.m_shop=new a.controller.Shop(b);this.m_construct()};Object.defineProperty(a.system.Main.prototype,"accommodation",{get:function(){return this.m_accommodation}});Object.defineProperty(a.system.Main.prototype,"activity",{get:function(){return this.m_activity}});
Object.defineProperty(a.system.Main.prototype,"attraction",{get:function(){return this.m_attraction}});Object.defineProperty(a.system.Main.prototype,"establishment",{get:function(){return this.m_establishment}});Object.defineProperty(a.system.Main.prototype,"food",{get:function(){return this.m_food}});Object.defineProperty(a.system.Main.prototype,"shop",{get:function(){return this.m_shop}});a.system.Main.prototype.m_construct=function(){};"undefined"!==typeof window&&"undefined"===typeof window.smapi&&(window.SMAPI=a.system.Main);}).call(this);
